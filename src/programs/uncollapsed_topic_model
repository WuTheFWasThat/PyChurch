assume ntopics 5
assume nwords 20

assume topics-dirichlet (symmetric-dirichlet-multinomial/make 1 ntopics)
assume words-dirichlet (symmetric-dirichlet-multinomial/make 1 nwords)

assume get-topic-dist (topics-dirichlet)

assume get-topic-words-dist ,
       (mem (lambda (i) (words-dirichlet)))

assume sample-dirichlet ,
       (lambda (prob_array) (let ((loop  ,
                                  (lambda (v i) ,
                                         (let ((w (prob_array i))) ,
                                          (if (< v w) i (loop (- v w) (+ i 1))))))) ,
                             (loop (rand) 0)))

assume get-topic (mem (lambda (i) (sample-dirichlet get-topic-dist)))

assume get-word (mem (lambda (i) (sample-dirichlet (get-topic-words-dist (get-topic i)))))

assume word0 (get-word 0)
assume word1 (get-word 1)
assume word2 (get-word 2)
assume word3 (get-word 3)

infer_many word0 100 100
